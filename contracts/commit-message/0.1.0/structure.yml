# Commit Message Structure Contract
# Version: 0.1.0
# Formal specification for semantic commit messages

version: "0.1.0"
name: "Semantic Commit Message Structure"
description: "Formal contract defining commit message structure for multi-module mono-repository"

# STRUCTURE SPECIFICATION
structure:
  - section: "top_level_heading"
    required: true
    format: "# <title>"
    max_length: 72

  - section: "summary"
    required: true
    format: "## Summary"

  - section: "files_affected"
    required: true
    format: "## Files affected"

  - section: "module_sections"
    required: true
    format: "## <module-name>"

# SEMANTIC TYPES
semantic_types:
  - "feat"      # New feature
  - "fix"       # Bug fix
  - "refactor"  # Code restructuring
  - "docs"      # Documentation
  - "chore"     # Maintenance
  - "test"      # Tests
  - "perf"      # Performance
  - "style"     # Formatting

# MODULE SUBJECT LINE FORMAT
subject_line_format: "<module>: <type>: <description>"

# CONSTRAINTS
constraints:
  max_line_length: 72  # HARD LIMIT - applies to Summary and module body text
  no_trailing_periods: true
  code_blocks_closed: true
  module_header_no_colons: true

# LINE WRAPPING RULES
wrapping:
  summary_body: 72      # CRITICAL: Every line in ## Summary body MUST be ≤72 chars
  module_body: 72       # CRITICAL: Every line in module body MUST be ≤72 chars
  exceptions:
    - "Markdown tables (| ... |)"
    - "Code blocks (``` ... ```)"
    - "YAML blocks"

# MARKDOWN RULES
markdown_rules:
  - rule: "MD041"
    description: "First line must be top-level heading"
    check: "First line starts with '# '"

  - rule: "MD022"
    description: "Headers should be surrounded by blank lines"
    check: "Blank line after '## Summary'"
    severity: "warning"

  - rule: "MD026"
    description: "Trailing punctuation in heading"
    check: "Title and subject lines must not end with period"

# ANTI-CORRUPTION LAYER
# Agents output pure content only - no meta-commentary
anti_corruption:
  enforcement: "extractContentBlock() function"
  forbidden_prefixes:
    - "Based on"
    - "Here is"
    - "Here's"
    - "Let me"
    - "I will"
    - "I'll"
    - "I've"
    - "The title"
    - "After reviewing"
  no_emojis: true
  no_wrapper_text: true
